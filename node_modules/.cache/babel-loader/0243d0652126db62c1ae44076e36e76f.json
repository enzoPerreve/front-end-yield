{"ast":null,"code":"import _toConsumableArray from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import poolsConfig from'config/constants/pools';import sousChefABI from'config/abi/sousChef.json';import cakeABI from'config/abi/cake.json';import wbnbABI from'config/abi/weth.json';import{QuoteToken}from'config/constants/types';import multicall from'utils/multicall';import{getWbnbAddress}from'utils/addressHelpers';import BigNumber from'bignumber.js';var CHAIN_ID=process.env.REACT_APP_CHAIN_ID;export var fetchPoolsBlockLimits=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var poolsWithEnd,callsStartBlock,callsEndBlock,starts,ends;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:poolsWithEnd=poolsConfig.filter(function(p){return p.sousId!==0;});callsStartBlock=poolsWithEnd.map(function(poolConfig){return{address:poolConfig.contractAddress[CHAIN_ID],name:'startBlock'};});callsEndBlock=poolsWithEnd.map(function(poolConfig){return{address:poolConfig.contractAddress[CHAIN_ID],name:'bonusEndBlock'};});_context.next=5;return multicall(sousChefABI,callsStartBlock);case 5:starts=_context.sent;_context.next=8;return multicall(sousChefABI,callsEndBlock);case 8:ends=_context.sent;return _context.abrupt(\"return\",poolsWithEnd.map(function(cakePoolConfig,index){var startBlock=starts[index];var endBlock=ends[index];return{sousId:cakePoolConfig.sousId,startBlock:new BigNumber(startBlock).toJSON(),endBlock:new BigNumber(endBlock).toJSON()};}));case 10:case\"end\":return _context.stop();}}},_callee);}));return function fetchPoolsBlockLimits(){return _ref.apply(this,arguments);};}();export var fetchPoolsTotalStatking=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var nonBnbPools,bnbPool,callsNonBnbPools,callsBnbPools,nonBnbPoolsTotalStaked,bnbPoolsTotalStaked;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:nonBnbPools=poolsConfig.filter(function(p){return p.stakingTokenName!==QuoteToken.BNB;});bnbPool=poolsConfig.filter(function(p){return p.stakingTokenName===QuoteToken.BNB;});callsNonBnbPools=nonBnbPools.map(function(poolConfig){return{address:poolConfig.stakingTokenAddress,name:'balanceOf',params:[poolConfig.contractAddress[CHAIN_ID]]};});callsBnbPools=bnbPool.map(function(poolConfig){return{address:getWbnbAddress(),name:'balanceOf',params:[poolConfig.contractAddress[CHAIN_ID]]};});_context2.next=6;return multicall(cakeABI,callsNonBnbPools);case 6:nonBnbPoolsTotalStaked=_context2.sent;_context2.next=9;return multicall(wbnbABI,callsBnbPools);case 9:bnbPoolsTotalStaked=_context2.sent;return _context2.abrupt(\"return\",[].concat(_toConsumableArray(nonBnbPools.map(function(p,index){return{sousId:p.sousId,totalStaked:new BigNumber(nonBnbPoolsTotalStaked[index]).toJSON()};})),_toConsumableArray(bnbPool.map(function(p,index){return{sousId:p.sousId,totalStaked:new BigNumber(bnbPoolsTotalStaked[index]).toJSON()};}))));case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPoolsTotalStatking(){return _ref2.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/src/state/pools/fetchPools.ts"],"names":["poolsConfig","sousChefABI","cakeABI","wbnbABI","QuoteToken","multicall","getWbnbAddress","BigNumber","CHAIN_ID","process","env","REACT_APP_CHAIN_ID","fetchPoolsBlockLimits","poolsWithEnd","filter","p","sousId","callsStartBlock","map","poolConfig","address","contractAddress","name","callsEndBlock","starts","ends","cakePoolConfig","index","startBlock","endBlock","toJSON","fetchPoolsTotalStatking","nonBnbPools","stakingTokenName","BNB","bnbPool","callsNonBnbPools","stakingTokenAddress","params","callsBnbPools","nonBnbPoolsTotalStaked","bnbPoolsTotalStaked","totalStaked"],"mappings":"wkBAAA,MAAOA,CAAAA,WAAP,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,0BAAxB,CACA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,OAASC,UAAT,KAA2B,wBAA3B,CACA,MAAOC,CAAAA,SAAP,KAAsB,iBAAtB,CACA,OAASC,cAAT,KAA+B,sBAA/B,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CAEA,GAAMC,CAAAA,QAAQ,CAAGC,OAAO,CAACC,GAAR,CAAYC,kBAA7B,CAEA,MAAO,IAAMC,CAAAA,qBAAqB,0FAAG,8LAC7BC,YAD6B,CACdb,WAAW,CAACc,MAAZ,CAAmB,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACC,MAAF,GAAa,CAApB,EAAnB,CADc,CAE7BC,eAF6B,CAEXJ,YAAY,CAACK,GAAb,CAAiB,SAACC,UAAD,CAAgB,CACvD,MAAO,CACLC,OAAO,CAAED,UAAU,CAACE,eAAX,CAA2Bb,QAA3B,CADJ,CAELc,IAAI,CAAE,YAFD,CAAP,CAID,CALuB,CAFW,CAQ7BC,aAR6B,CAQbV,YAAY,CAACK,GAAb,CAAiB,SAACC,UAAD,CAAgB,CACrD,MAAO,CACLC,OAAO,CAAED,UAAU,CAACE,eAAX,CAA2Bb,QAA3B,CADJ,CAELc,IAAI,CAAE,eAFD,CAAP,CAID,CALqB,CARa,uBAedjB,CAAAA,SAAS,CAACJ,WAAD,CAAcgB,eAAd,CAfK,QAe7BO,MAf6B,qCAgBhBnB,CAAAA,SAAS,CAACJ,WAAD,CAAcsB,aAAd,CAhBO,QAgB7BE,IAhB6B,+CAkB5BZ,YAAY,CAACK,GAAb,CAAiB,SAACQ,cAAD,CAAiBC,KAAjB,CAA2B,CACjD,GAAMC,CAAAA,UAAU,CAAGJ,MAAM,CAACG,KAAD,CAAzB,CACA,GAAME,CAAAA,QAAQ,CAAGJ,IAAI,CAACE,KAAD,CAArB,CACA,MAAO,CACLX,MAAM,CAAEU,cAAc,CAACV,MADlB,CAELY,UAAU,CAAE,GAAIrB,CAAAA,SAAJ,CAAcqB,UAAd,EAA0BE,MAA1B,EAFP,CAGLD,QAAQ,CAAE,GAAItB,CAAAA,SAAJ,CAAcsB,QAAd,EAAwBC,MAAxB,EAHL,CAAP,CAKD,CARM,CAlB4B,yDAAH,kBAArBlB,CAAAA,qBAAqB,0CAA3B,CA6BP,MAAO,IAAMmB,CAAAA,uBAAuB,2FAAG,0OAC/BC,WAD+B,CACjBhC,WAAW,CAACc,MAAZ,CAAmB,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACkB,gBAAF,GAAuB7B,UAAU,CAAC8B,GAAzC,EAAnB,CADiB,CAE/BC,OAF+B,CAErBnC,WAAW,CAACc,MAAZ,CAAmB,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACkB,gBAAF,GAAuB7B,UAAU,CAAC8B,GAAzC,EAAnB,CAFqB,CAI/BE,gBAJ+B,CAIZJ,WAAW,CAACd,GAAZ,CAAgB,SAACC,UAAD,CAAgB,CACvD,MAAO,CACLC,OAAO,CAAED,UAAU,CAACkB,mBADf,CAELf,IAAI,CAAE,WAFD,CAGLgB,MAAM,CAAE,CAACnB,UAAU,CAACE,eAAX,CAA2Bb,QAA3B,CAAD,CAHH,CAAP,CAKD,CANwB,CAJY,CAY/B+B,aAZ+B,CAYfJ,OAAO,CAACjB,GAAR,CAAY,SAACC,UAAD,CAAgB,CAChD,MAAO,CACLC,OAAO,CAAEd,cAAc,EADlB,CAELgB,IAAI,CAAE,WAFD,CAGLgB,MAAM,CAAE,CAACnB,UAAU,CAACE,eAAX,CAA2Bb,QAA3B,CAAD,CAHH,CAAP,CAKD,CANqB,CAZe,wBAoBAH,CAAAA,SAAS,CAACH,OAAD,CAAUkC,gBAAV,CApBT,QAoB/BI,sBApB+B,uCAqBHnC,CAAAA,SAAS,CAACF,OAAD,CAAUoC,aAAV,CArBN,QAqB/BE,mBArB+B,8EAwBhCT,WAAW,CAACd,GAAZ,CAAgB,SAACH,CAAD,CAAIY,KAAJ,QAAe,CAChCX,MAAM,CAAED,CAAC,CAACC,MADsB,CAEhC0B,WAAW,CAAE,GAAInC,CAAAA,SAAJ,CAAciC,sBAAsB,CAACb,KAAD,CAApC,EAA6CG,MAA7C,EAFmB,CAAf,EAAhB,CAxBgC,qBA4BhCK,OAAO,CAACjB,GAAR,CAAY,SAACH,CAAD,CAAIY,KAAJ,QAAe,CAC5BX,MAAM,CAAED,CAAC,CAACC,MADkB,CAE5B0B,WAAW,CAAE,GAAInC,CAAAA,SAAJ,CAAckC,mBAAmB,CAACd,KAAD,CAAjC,EAA0CG,MAA1C,EAFe,CAAf,EAAZ,CA5BgC,6DAAH,kBAAvBC,CAAAA,uBAAuB,2CAA7B","sourcesContent":["import poolsConfig from 'config/constants/pools'\nimport sousChefABI from 'config/abi/sousChef.json'\nimport cakeABI from 'config/abi/cake.json'\nimport wbnbABI from 'config/abi/weth.json'\nimport { QuoteToken } from 'config/constants/types'\nimport multicall from 'utils/multicall'\nimport { getWbnbAddress } from 'utils/addressHelpers'\nimport BigNumber from 'bignumber.js'\n\nconst CHAIN_ID = process.env.REACT_APP_CHAIN_ID\n\nexport const fetchPoolsBlockLimits = async () => {\n  const poolsWithEnd = poolsConfig.filter((p) => p.sousId !== 0)\n  const callsStartBlock = poolsWithEnd.map((poolConfig) => {\n    return {\n      address: poolConfig.contractAddress[CHAIN_ID],\n      name: 'startBlock',\n    }\n  })\n  const callsEndBlock = poolsWithEnd.map((poolConfig) => {\n    return {\n      address: poolConfig.contractAddress[CHAIN_ID],\n      name: 'bonusEndBlock',\n    }\n  })\n\n  const starts = await multicall(sousChefABI, callsStartBlock)\n  const ends = await multicall(sousChefABI, callsEndBlock)\n\n  return poolsWithEnd.map((cakePoolConfig, index) => {\n    const startBlock = starts[index]\n    const endBlock = ends[index]\n    return {\n      sousId: cakePoolConfig.sousId,\n      startBlock: new BigNumber(startBlock).toJSON(),\n      endBlock: new BigNumber(endBlock).toJSON(),\n    }\n  })\n}\n\nexport const fetchPoolsTotalStatking = async () => {\n  const nonBnbPools = poolsConfig.filter((p) => p.stakingTokenName !== QuoteToken.BNB)\n  const bnbPool = poolsConfig.filter((p) => p.stakingTokenName === QuoteToken.BNB)\n\n  const callsNonBnbPools = nonBnbPools.map((poolConfig) => {\n    return {\n      address: poolConfig.stakingTokenAddress,\n      name: 'balanceOf',\n      params: [poolConfig.contractAddress[CHAIN_ID]],\n    }\n  })\n\n  const callsBnbPools = bnbPool.map((poolConfig) => {\n    return {\n      address: getWbnbAddress(),\n      name: 'balanceOf',\n      params: [poolConfig.contractAddress[CHAIN_ID]],\n    }\n  })\n\n  const nonBnbPoolsTotalStaked = await multicall(cakeABI, callsNonBnbPools)\n  const bnbPoolsTotalStaked = await multicall(wbnbABI, callsBnbPools)\n\n  return [\n    ...nonBnbPools.map((p, index) => ({\n      sousId: p.sousId,\n      totalStaked: new BigNumber(nonBnbPoolsTotalStaked[index]).toJSON(),\n    })),\n    ...bnbPool.map((p, index) => ({\n      sousId: p.sousId,\n      totalStaked: new BigNumber(bnbPoolsTotalStaked[index]).toJSON(),\n    })),\n  ]\n}\n"]},"metadata":{},"sourceType":"module"}