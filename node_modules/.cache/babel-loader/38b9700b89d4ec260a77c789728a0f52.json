{"ast":null,"code":"import _regeneratorRuntime from\"/Users/florianc/Documents/PERSO/blockchain/PolyRhino/polyrhino-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/florianc/Documents/PERSO/blockchain/PolyRhino/polyrhino-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/florianc/Documents/PERSO/blockchain/PolyRhino/polyrhino-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/florianc/Documents/PERSO/blockchain/PolyRhino/polyrhino-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";/* eslint-disable no-param-reassign */import{createSlice}from'@reduxjs/toolkit';import farmsConfig from'config/constants/farms';import fetchFarms from'./fetchFarms';import{fetchFarmUserEarnings,fetchFarmUserAllowances,fetchFarmUserTokenBalances,fetchFarmUserStakedBalances}from'./fetchFarmUser';var initialState={data:_toConsumableArray(farmsConfig)};export var farmsSlice=createSlice({name:'Farms',initialState:initialState,reducers:{setFarmsPublicData:function setFarmsPublicData(state,action){var liveFarmsData=action.payload;state.data=state.data.map(function(farm){var liveFarmData=liveFarmsData.find(function(f){return f.pid===farm.pid;});return _objectSpread(_objectSpread({},farm),liveFarmData);});},setFarmUserData:function setFarmUserData(state,action){var arrayOfUserDataObjects=action.payload.arrayOfUserDataObjects;arrayOfUserDataObjects.forEach(function(userDataEl){var index=userDataEl.index;state.data[index]=_objectSpread(_objectSpread({},state.data[index]),{},{userData:userDataEl});});}}});// Actions\nvar _farmsSlice$actions=farmsSlice.actions,setFarmsPublicData=_farmsSlice$actions.setFarmsPublicData,setFarmUserData=_farmsSlice$actions.setFarmUserData;// Thunks\nexport{setFarmsPublicData,setFarmUserData};export var fetchFarmsPublicDataAsync=function fetchFarmsPublicDataAsync(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var farms;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchFarms();case 2:farms=_context.sent;dispatch(setFarmsPublicData(farms));case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var fetchFarmUserDataAsync=function fetchFarmUserDataAsync(account){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var userFarmAllowances,userFarmTokenBalances,userStakedBalances,userFarmEarnings,arrayOfUserDataObjects;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchFarmUserAllowances(account);case 2:userFarmAllowances=_context2.sent;_context2.next=5;return fetchFarmUserTokenBalances(account);case 5:userFarmTokenBalances=_context2.sent;_context2.next=8;return fetchFarmUserStakedBalances(account);case 8:userStakedBalances=_context2.sent;_context2.next=11;return fetchFarmUserEarnings(account);case 11:userFarmEarnings=_context2.sent;arrayOfUserDataObjects=userFarmAllowances.map(function(farmAllowance,index){return{index:index,allowance:userFarmAllowances[index],tokenBalance:userFarmTokenBalances[index],stakedBalance:userStakedBalances[index],earnings:userFarmEarnings[index]};});dispatch(setFarmUserData({arrayOfUserDataObjects:arrayOfUserDataObjects}));case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export default farmsSlice.reducer;","map":{"version":3,"sources":["/Users/florianc/Documents/PERSO/blockchain/PolyRhino/polyrhino-frontend-master/src/state/farms/index.ts"],"names":["createSlice","farmsConfig","fetchFarms","fetchFarmUserEarnings","fetchFarmUserAllowances","fetchFarmUserTokenBalances","fetchFarmUserStakedBalances","initialState","data","farmsSlice","name","reducers","setFarmsPublicData","state","action","liveFarmsData","payload","map","farm","liveFarmData","find","f","pid","setFarmUserData","arrayOfUserDataObjects","forEach","userDataEl","index","userData","actions","fetchFarmsPublicDataAsync","dispatch","farms","fetchFarmUserDataAsync","account","userFarmAllowances","userFarmTokenBalances","userStakedBalances","userFarmEarnings","farmAllowance","allowance","tokenBalance","stakedBalance","earnings","reducer"],"mappings":"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","sourcesContent":["/* eslint-disable no-param-reassign */\nimport { createSlice } from '@reduxjs/toolkit'\nimport farmsConfig from 'config/constants/farms'\nimport fetchFarms from './fetchFarms'\nimport {\n  fetchFarmUserEarnings,\n  fetchFarmUserAllowances,\n  fetchFarmUserTokenBalances,\n  fetchFarmUserStakedBalances,\n} from './fetchFarmUser'\nimport { FarmsState, Farm } from '../types'\n\nconst initialState: FarmsState = { data: [...farmsConfig] }\n\nexport const farmsSlice = createSlice({\n  name: 'Farms',\n  initialState,\n  reducers: {\n    setFarmsPublicData: (state, action) => {\n      const liveFarmsData: Farm[] = action.payload\n      state.data = state.data.map((farm) => {\n        const liveFarmData = liveFarmsData.find((f) => f.pid === farm.pid)\n        return { ...farm, ...liveFarmData }\n      })\n    },\n    setFarmUserData: (state, action) => {\n      const { arrayOfUserDataObjects } = action.payload\n      arrayOfUserDataObjects.forEach((userDataEl) => {\n        const { index } = userDataEl\n        state.data[index] = { ...state.data[index], userData: userDataEl }\n      })\n    },\n  },\n})\n\n// Actions\nexport const { setFarmsPublicData, setFarmUserData } = farmsSlice.actions\n\n// Thunks\nexport const fetchFarmsPublicDataAsync = () => async (dispatch) => {\n  const farms = await fetchFarms()\n  dispatch(setFarmsPublicData(farms))\n}\nexport const fetchFarmUserDataAsync = (account) => async (dispatch) => {\n  const userFarmAllowances = await fetchFarmUserAllowances(account)\n  const userFarmTokenBalances = await fetchFarmUserTokenBalances(account)\n  const userStakedBalances = await fetchFarmUserStakedBalances(account)\n  const userFarmEarnings = await fetchFarmUserEarnings(account)\n\n  const arrayOfUserDataObjects = userFarmAllowances.map((farmAllowance, index) => {\n    return {\n      index,\n      allowance: userFarmAllowances[index],\n      tokenBalance: userFarmTokenBalances[index],\n      stakedBalance: userStakedBalances[index],\n      earnings: userFarmEarnings[index],\n    }\n  })\n\n  dispatch(setFarmUserData({ arrayOfUserDataObjects }))\n}\n\nexport default farmsSlice.reducer\n"]},"metadata":{},"sourceType":"module"}