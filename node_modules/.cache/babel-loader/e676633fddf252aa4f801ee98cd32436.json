{"ast":null,"code":"import _regeneratorRuntime from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useMemo,useState,useCallback}from'react';import styled from'styled-components';import{getContract}from'utils/erc20';import{Button,Flex,Text}from'@pancakeswap-libs/uikit';import{useFarmFromPid,useFarmUser}from'state/hooks';import useI18n from'hooks/useI18n';import UnlockButton from'components/UnlockButton';import{useApprove}from'hooks/useApprove';import StakeAction from'./StakeAction';import HarvestAction from'./HarvestAction';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Action=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding-top: 16px;\\n\"])));var CardActions=function CardActions(_ref){var farm=_ref.farm,ethereum=_ref.ethereum,account=_ref.account;var TranslateString=useI18n();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useFarmFromPid=useFarmFromPid(farm.pid),pid=_useFarmFromPid.pid,lpAddresses=_useFarmFromPid.lpAddresses,tokenAddresses=_useFarmFromPid.tokenAddresses,isTokenOnly=_useFarmFromPid.isTokenOnly,depositFeeBP=_useFarmFromPid.depositFeeBP,decimal=_useFarmFromPid.decimal;var _useFarmUser=useFarmUser(pid),allowance=_useFarmUser.allowance,tokenBalance=_useFarmUser.tokenBalance,stakedBalance=_useFarmUser.stakedBalance,earnings=_useFarmUser.earnings;var lpAddress=lpAddresses[process.env.REACT_APP_CHAIN_ID];var tokenAddress=tokenAddresses[process.env.REACT_APP_CHAIN_ID];var lpName=farm.lpSymbol.toUpperCase();var isApproved=account&&allowance&&allowance.isGreaterThan(0);var lpContract=useMemo(function(){if(isTokenOnly){return getContract(ethereum,tokenAddress);}return getContract(ethereum,lpAddress);},[ethereum,lpAddress,tokenAddress,isTokenOnly]);var _useApprove=useApprove(lpContract),onApprove=_useApprove.onApprove;var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:setRequestedApproval(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[onApprove]);var renderApprovalOrStakeButton=function renderApprovalOrStakeButton(){return isApproved?/*#__PURE__*/_jsx(StakeAction,{stakedBalance:stakedBalance,tokenBalance:tokenBalance,tokenName:lpName,pid:pid,depositFeeBP:depositFeeBP,decimal:decimal}):/*#__PURE__*/_jsx(Button,{mt:\"8px\",fullWidth:true,disabled:requestedApproval,onClick:handleApprove,children:TranslateString(999,'Approve Contract')});};return/*#__PURE__*/_jsxs(Action,{children:[/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:\"LION\"}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(999,'Earned')})]}),/*#__PURE__*/_jsx(HarvestAction,{earnings:earnings,pid:pid,decimal:decimal}),/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:lpName}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(999,'Staked')})]}),!account?/*#__PURE__*/_jsx(UnlockButton,{mt:\"8px\",fullWidth:true}):renderApprovalOrStakeButton()]});};export default CardActions;","map":{"version":3,"sources":["/Users/florianc/Documents/PERSO/blockchain/Polyion/polyion-frontend-master/src/views/Farms/components/FarmCard/CardActionsContainer.tsx"],"names":["React","useMemo","useState","useCallback","styled","getContract","Button","Flex","Text","useFarmFromPid","useFarmUser","useI18n","UnlockButton","useApprove","StakeAction","HarvestAction","Action","div","CardActions","farm","ethereum","account","TranslateString","requestedApproval","setRequestedApproval","pid","lpAddresses","tokenAddresses","isTokenOnly","depositFeeBP","decimal","allowance","tokenBalance","stakedBalance","earnings","lpAddress","process","env","REACT_APP_CHAIN_ID","tokenAddress","lpName","lpSymbol","toUpperCase","isApproved","isGreaterThan","lpContract","onApprove","handleApprove","console","error","renderApprovalOrStakeButton"],"mappings":"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","sourcesContent":["import React, { useMemo, useState, useCallback } from 'react'\nimport BigNumber from 'bignumber.js'\nimport styled from 'styled-components'\nimport { provider } from 'web3-core'\nimport { getContract } from 'utils/erc20'\nimport { Button, Flex, Text } from '@pancakeswap-libs/uikit'\nimport { Farm } from 'state/types'\nimport { useFarmFromPid, useFarmFromSymbol, useFarmUser } from 'state/hooks'\nimport useI18n from 'hooks/useI18n'\nimport UnlockButton from 'components/UnlockButton'\nimport { useApprove } from 'hooks/useApprove'\nimport StakeAction from './StakeAction'\nimport HarvestAction from './HarvestAction'\n\nconst Action = styled.div`\n  padding-top: 16px;\n`\nexport interface FarmWithStakedValue extends Farm {\n  apy?: BigNumber\n}\n\ninterface FarmCardActionsProps {\n  farm: FarmWithStakedValue\n  ethereum?: provider\n  account?: string\n}\n\nconst CardActions: React.FC<FarmCardActionsProps> = ({ farm, ethereum, account }) => {\n  const TranslateString = useI18n()\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { pid, lpAddresses, tokenAddresses, isTokenOnly, depositFeeBP, decimal } = useFarmFromPid(farm.pid)\n  const { allowance, tokenBalance, stakedBalance, earnings } = useFarmUser(pid)\n  const lpAddress = lpAddresses[process.env.REACT_APP_CHAIN_ID]\n  const tokenAddress = tokenAddresses[process.env.REACT_APP_CHAIN_ID];\n  const lpName = farm.lpSymbol.toUpperCase()\n  const isApproved = account && allowance && allowance.isGreaterThan(0)\n\n  const lpContract = useMemo(() => {\n    if(isTokenOnly){\n      return getContract(ethereum as provider, tokenAddress);\n    }\n    return getContract(ethereum as provider, lpAddress);\n  }, [ethereum, lpAddress, tokenAddress, isTokenOnly])\n\n  const { onApprove } = useApprove(lpContract)\n\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      await onApprove()\n      setRequestedApproval(false)\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onApprove])\n\n  const renderApprovalOrStakeButton = () => {\n    return isApproved ? (\n      <StakeAction stakedBalance={stakedBalance} tokenBalance={tokenBalance} tokenName={lpName} pid={pid} depositFeeBP={depositFeeBP} decimal={decimal} />\n    ) : (\n      <Button mt=\"8px\" fullWidth disabled={requestedApproval} onClick={handleApprove}>\n        {TranslateString(999, 'Approve Contract')}\n      </Button>\n    )\n  }\n\n  return (\n    <Action>\n      <Flex>\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\n          {/* TODO: Is there a way to get a dynamic value here from useFarmFromSymbol? */}\n          LION\n        </Text>\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\n          {TranslateString(999, 'Earned')}\n        </Text>\n      </Flex>\n      <HarvestAction earnings={earnings} pid={pid} decimal={decimal}/>\n      <Flex>\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\n          {lpName}\n        </Text>\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\n          {TranslateString(999, 'Staked')}\n        </Text>\n      </Flex>\n      {!account ? <UnlockButton mt=\"8px\" fullWidth /> : renderApprovalOrStakeButton()}\n    </Action>\n  )\n}\n\nexport default CardActions\n"]},"metadata":{},"sourceType":"module"}